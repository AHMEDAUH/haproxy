---
agent_version: "latest"  # Default version, can be overridden
agent_url: "https://download.instant-agent.com/agent.rpm"  # Replace with the actual URL




---
- name: Ensure system is updated
  dnf:
    name: '*'
    state: latest
  become: true

- name: Download the Instant Agent RPM package
  get_url:
    url: "{{ agent_url }}"
    dest: "/tmp/instant-agent.rpm"
  become: true

- name: Install Instant Agent
  dnf:
    name: "/tmp/instant-agent.rpm"
    state: present
  become: true

- name: Clean up RPM package
  file:
    path: "/tmp/instant-agent.rpm"
    state: absent
  become: true




---
- name: Restart Instant Agent service
  service:
    name: instant-agent
    state: restarted
  become: true




---
- name: Install Instant Agent on RHEL 8
  hosts: rhel8_servers
  become: true
  roles:
    - instant-agent
